# Базовая архитектура

## Слои и основные компоненты

### Клиентский слой

- Мобильные приложения (iOS/Android)
- Веб-клиент для поддержки части административных, маркетинговых и пользовательских функций

### API Gateway / BFF

Отвечает за агрегацию данных, трансляцию протоколов (GraphQL/REST), rate limiting (анти DDoS) и termination TLS (шифрование трафика)

### Доменные микросервисы

- **Идентификация и приватность (CIAM):** Регистрация, аутентификация (OAuth2/OIDC), управление пользователями и согласиями (профиль), SSO, MFA
- **Тренировки и телеметрия:** Запись, хранение и аналитика тренировок, обработка данных с устройств, синхронизация с устройствами
- **Сообщество и группы:** Группы, челленджи, лента активности, уведомления
- **Коммерция и продажи:** Витрина товаров, корзина, оформление заказов, персональные предложения, интеграция с e-commerce (Anticorruption Layer для подключения к существующей системе e-commerce)
- **Управление экипировкой:** Учет экипировки пользователя, подсказки по замене, история использования
- **Персонализация и рекомендации:** Генерация персональных рекомендаций, новостей и промо на основе активности и профиля
- **Региональные подразделения:** Региональные акции, новости по интересам, таргетинг
- **Локализация и региональные правила** Хранение и применение данных по языкам, валютам, единицам измерения, юридическим ограничения

### Сервисы инфраструктуры

- **Брокер сообщений (Event Bus):** Асинхронная коммуникация и событийная интеграция между микросервисами
- **Мониторинг:** OpenTelemetry, Prometheus, Grafana, централизованный SIEM
- **API Gateway/WAF (в каждом домене)**: Безопасность, termination TLS, DDoS protection

### Слои хранения данных

- **RDBMS:** Профиль, заказы, коммерция
- **TSDB:** Тренировки, телеметрия
- **GraphDB/Elastic:** Социальный граф, лента
- **Object Storage:** Медиафайлы, фото, видео
- **VectorDB:** Рекомендации и персонализация


## Атрибуты качества

|Атрибут качества|Описание|
|------|------|
|Масштабируемость| K8s, микросервисы, event-driven, полиглот хранилища, multi-region/multi-cloud|
|Доступность| Multi-region, primary+secondary по доменам, автоматический failover, SLA/SLO мониторинг|
|Безопасность| TLS/mTLS, OAuth2/OIDC, WAF, Zero Trust|
|Производительность| Горизонтальное масштабирование сервисов, кэширование, оптимизированные базы под тип нагрузки|
|Наблюдаемость| OpenTelemetry, централизованный SIEM, метрики и алерты по бизнес и техническим событиям|
|Интероперабельность| Public API, интеграции с внешними устройствами и e-commerce, BFF/GraphQL|


## Графическое представление

