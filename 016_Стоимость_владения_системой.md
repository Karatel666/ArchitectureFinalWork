# Стоимость владения системой 

 
## Пользователи

|Год|MAU (Monthly Active Users)|DAU (Daily Active Users)|
|---|---|---|
|Год 1|200k|80k|
|Год 2|1M|400k|
|Год 5|5M|2M|

## Тренировки (TSDB)

|Показатель|Значение |
|-----|---|
|Среднее число тренировок на активного пользователя в день|0,45|
|Доля тренировок с медиа|15%|
|Телеметрия на тренировку (после нормализации/сжатия)| 1,5 MB (raw)|
|Хранение raw| 30 дней (TSDB hot)|
|Хранение (warm) 12 месяцев| 0,15 MB/тренировка (10% от raw)|
|Прирост в год|15 MB|

<b>Тренировки:</b> ~40 MB на пользователя в год

## Данные пользователя (RDBMS)

|Показатель|Значение (на пользователя в год)|
|-----|---|
|Профиль/CIAM (ID, логин, e-mail/телефон, locale/единицы, хеш пароля/SSO ссылку, device links, согласия, 1–2 адреса)| 30 KB|
|Инвентарь (5 позиций по 1 KB + агрегаты/счётчики использования)|5 KB|
|Подписки (план, статусы)|3 KB|
|Индексы/оверхед (email/phone/uid/foreign keys)|x1,5 от основных данных|
|Прирост в год|10 KB|

<b>Данные пользователя:</b> 57 KB на пользователя в год

## Фото и файлы (Объектное хранилище)

|Показатель|Значение (на пользователя в год)|
|-----|---|
|Фото профиля|150 KB|
|Фото инветаря (в среднем по 5 вещей в инвентаре)|5x150 KB = 650 KB|
|Чекин на покупку (в среднем 2 чека на пользователя)| 2x50 KB = 100 KB|
|Прирост в год|---|

<b>Фото и файлы:</b> 900 KB

## Объемы хранения

### Коэффициенты физического объема с учетом репликаций/бэкапов
- TSDB: внутрирегиональная избыточность хранения (репликация) в TSDB-кластере 2, 2 региона (primary + secondary), бэкапы/снапшоты 20%  = 4,8 x объем
- RDBMS: 2 региона (primary+secondary) + бэкапы/снапшоты 20%  = 2,4 x объем
- Объектное: без кросс-региональной репликации по умолчанию + версияция/метаданные 10%  = 1,1 x объем


### Итоговый объем PROD

Формулы:
- TSDB = DAU x 40 MB x 4,8
- RDBMS = MAU x 57 KB x 2,4
- Object = MAU x 900 KB x 1,1

|Год|TSDB|RDBMS|Object Storage|
|---|---|---|---|
|Год 1| 15,36 TB |27,36 GB|198 GB|
|Год 2|76,80 TB|136,80 GB|990 GB|
|Год 5|384 TB|684 GB|4,95 TB|

### Непроизводственные среды

Год 1

|Среда|TSDB|RDBMS|Object|Итого|
|---|---|---|---|---|
|Dev (0,2xprod)|3,072 TB|5,472 GB|39,6 GB|3,117 TB|
|QA (0,5xprod)|7,680 TB|13,68 GB|99 GB|7,793 TB|
|Preprod (0,7xprod)|10,752 TB|19,152 GB|138,6 GB|10,910 TB|

Год 2

|Среда|TSDB|RDBMS|Object|Итого|
|---|---|---|---|---|
|Dev (0,2xprod)|15,36 TB|27,36 GB|198 GB|15,585 TB|
|QA (0,5xprod)|38,40 TB|68,40 GB|495 GB|38,963 TB|
|Preprod (0,7xprod)|53,76 TB|95,76 GB|693 GB|54,549 TB|

Год 5
|Среда|TSDB|RDBMS|Object|Итого|
|---|---|---|---|---|
|Dev (0,2xprod)|76,80 TB|136,8 GB|990 GB|77,927 TB|
|QA (0,5xprod)|192 TB|342 GB|2 475 GB|194,817 TB|
|Preprod (0,7xprod)|268,80 TB|478,8 GB|3 465 GB|272,744 TB|

### Логи, метрики, трейсы (наблюдаемость)

5% от TSDB объма (логика: объем наблюдаемости в среднем масштабируется с интенсивностью событий/телеметрии)

<b>Prod</b>
- Год 1: 0,768 TB
- Год 2: 3,840 TB
- Год 5: 19,200 TB

<b>Непрод (по средам)</b>

|Год|Dev|QA|Preprod|
|---|---|---|---|
|Год 1|0,154 TB|0,384 TB|0,538 TB|
|Год 2|0,768 TB|1,920 TB|2,688 TB|
|Год 5|3,840 TB|9,600 TB|13,440 TB|

