# Анализ архитектурных опций

## Стиль системы/декомпозиция

**Подход: <u>Доменно-ориентированные микросервисы</u>**

**Обоснование:** Четкие границы ответственности доменов и возможность независимых релизов, что быстро позволит развивать социальные функции, интеграции с устройствами, персонализацию, эксперименты с промо-акциями. Масштабируемость под большие объемы (глобальные челленджи, соревнования, миллионы пользователей). Поддержка multi-cloud.

**Отклоненные опции:**
1. **Модульный монолит**. Быстрый старт MVP, четкие границы, но узкий для глобального масштаба, сложно эффективно масштабировать по частям, ограничение роста. В монолите сложнее реализовать изоляцию и сегментацию данных по регионам, усложняется контроль над потоками персональных данных.
2. **SOA/ESB**. Рассматривалась, т.к. используется для интеграции разнородных систем, упрощения взаимодействия между сервисами, поддержки корпоративных процессов. Отклонена из-за избыточной связность, риска «бутылочного горлышка», высокого времени вывода новых фич, зависимость от команды сопровождения ESB. ESB обычно разворачивается в одном дата-центре/облаке, сложен для глобального multi-cloud и требует ручной поддержки.

## Взаимодействие между доменами

**Подход: <u>Event-driven + REST</u>** 

**Обоснование:** Event-driven позволяет управлять асинхронно большим объемом событий  типа  обновления ленты новостей, рассылка уведомлений, запуск промо-акций, обработка данных от устройств и интеграций, обеспечивает слабую связность между доменати. REST для синхронных запросов данных, для слабо нагруженных синхронных и latency-critical сценариев.

**Отклоненные опции:**
1. **Только REST**. Прост в реализации и поддержке, подходит для синхронных запросов и хорошо поддерживается большинством языков и фреймворков. Но деградация производительности и доступности системы в пиковые моменты. Многие сценарии требуют событийной архитектуры. Плохо масштабируется на сложные интеграционные сценарии, где нужно уведомлять десятки/сотни потребителей о событии.

## Хранение данных

**Выбор: <u>Отдельные БД. Разные типы БД в зависимости от задач домена</u>**

**Обоснование:**  Независимое масштабирование по доменам, целевые SLO в зависимости от сенариев и данных, меньшие операционные риски, гибкость эволюции (можно улучшать один домен, не ломая остальные): 
- Реляционная база данных для тех доменов, в которых требуется строгие требования к целостности, транзакционности, поддержка сложных связей, проверка уникальности: данные профиля пользователя, регистрация, заказы, корзины. 
- TSDB (База данных временных рядов) для хранение данных о тренировках, показателях датчиков (время, пульс, скорость, маршруты), событий активности пользователей. 
- Graph DB: связи между пользователями, группами, подписки, лента новостей, рекомендации друзей. 
- Vector DB: поиск похожих товаров, пользователей, маршрутов, персонализированные рекомендации.

**Отклоненные опции:** 
1. Единая реляционная БД. Несоответствие нагрузкам и моделям данных, не тянет граф для выстраивания социальных взаимодейтсвий и тайм-серии для тренировок.  Горизонтальное масштабирование сложно и дорого. Разные домены будут конкурировать за одни и те же ресурсы.
2. Единая NoSQL — проблемная консистентность/транзакции

## Мобильные клиенты

**Выбор:** Native iOS/Android (+ возможен RN/Flutter для второстепенных экранов)

**Обоснование:** Глубокая интеграция сенсоров/фоновых задач, лучшая UX/энергия

**Отклоненные опции:**
Чистая кроссплатформа — риски с сенсорами/фоновой телеметрией; Web-only — невозможны ключевые сценарии

## Развертывание

**Выбор:** Multi-cloud: primary+secondary по доменам, multi-region внутр

**Обоснование:** Соответствует ландшафту компании, управляемая сложность/затраты

**Отклоненные опции:**
Один облак — противоречит практике; Полный актив-актив кросс-облака — слишком сложен и дорог Полный актив-актив между облаками: технически возможно, но TCO и сложность наблюдаемости/данных неоправданны для старта → primary+secondary.






